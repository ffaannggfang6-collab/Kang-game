<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Kang Game</title>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body style="background:#111;color:#fff;text-align:center;">
  <h1>üêâ KANG GAME</h1>

  <div id="login">
    <input id="username" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô">
    <button onclick="login()">‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°</button>
  </div>

  <div id="lobby" style="display:none">
    <h2>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á</h2>
    <div id="rooms"></div>
  </div>

  <div id="room" style="display:none">
    <h2>‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á</h2>
    <ul id="players"></ul>
    <button onclick="kang()">‡πÅ‡∏Ñ‡∏á</button>
    <p id="result"></p>
  </div>

<script>
  const socket = io();

  function login(){
    const name = username.value;
    socket.emit('login', name);
  }

  socket.on('login_success', data => {
    login.style.display = 'none';
    lobby.style.display = 'block';

    for(const id in data.rooms){
      rooms.innerHTML +=
        `<button onclick="join(${id})">‡∏´‡πâ‡∏≠‡∏á ${id}</button><br>`;
    }
  });

  function join(id){
    socket.emit('join_room', id);
    lobby.style.display = 'none';
    room.style.display = 'block';
  }

  socket.on('room_update', list => {
    players.innerHTML = list.map(p => `<li>${p}</li>`).join('');
  });

  function kang(){
    socket.emit('KANG');
  }

  socket.on('game_result', r => {
    result.innerText = `‡∏ú‡∏π‡πâ‡∏ä‡∏ô‡∏∞: ${r.winner} ‡πÑ‡∏î‡πâ ${r.win} ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï`;
  });
</script>
</body>
</html>
